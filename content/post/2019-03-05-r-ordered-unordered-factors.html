---
title: R ä¸­å› å­å‹å˜é‡çš„æœ‰åºä¸æ— åº
author: Jackie
date: '2019-03-05'
slug: r-ordered-unordered-factors
categories:
  - R
tags:
  - R
  - åŸºç¡€
  - é—®é¢˜
  - stats
disable_comments: no
show_toc: yes
output:
  blogdown::html_page:
    toc: true
---


<div id="TOC">
<ul>
<li><a>æœ‰åºå’Œæ— åºå› å­å˜é‡</a></li>
<li><a>ä¾‹å­</a></li>
<li><a>è§£è¯»</a></li>
<li><a>æ¨¡å‹è¯„ä»·å’Œæ¯”è¾ƒ</a></li>
<li><a>ç»“è¯­</a></li>
</ul>
</div>

<p>ä»Šå¤©æ¶‰åŠåˆ°çš„è¿™ä¸ªå°±å¾ˆæœ‰æ„æ€äº†ã€‚å¾ˆæ—©å¼€å§‹æˆ‘å°±å¯¹è¿™ä¸ªé—®é¢˜æœ‰ç‚¹ç–‘æƒ‘ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰æŠ½å‡ºæ—¶é—´ï¼ˆå¥½å§ï¼Œå…¶å®ä¸»è¦è¿˜æ˜¯æˆ‘å¤ªæ‡’ï¼‰å¥½å¥½äº†è§£ä¸€ä¸‹ã€‚å‰é˜µç¢°åˆ°æ•°æ®åšå›å½’å°±è§‰å¾—åˆ°äº†ä¸å¾—ä¸æŸ¥ä¸€ä¸‹è¿™ä¸ªé—®é¢˜çš„æ—¶å€™äº†æ‰ç¨å¾®æŸ¥äº†ä¸€ä¸‹ã€‚</p>
<p>äº‹å…ˆå£°æ˜ï¼Œå…¶å®è¿™ä¸ªé—®é¢˜æˆ‘åˆ°ç°åœ¨éƒ½æ‡‚çš„ä¸æ˜¯å¾ˆå¤šï¼Œé‡Œé¢æ¶‰åŠä¸€äº›ç»Ÿè®¡æ–¹é¢çš„ä¸œè¥¿æ²¡æœ‰æ‰¾åˆ°å¾ˆå¥½çš„èµ„æ–™ï¼Œæ‰€ä»¥è¿™ç¯‡åšæ–‡ä¸»è¦æ³¨é‡å®ç”¨ï¼Œä¹Ÿå¯èƒ½è¿˜ä¼šæœ‰é”™è¯¯ï¼Œæˆ‘å†™å‡ºæ¥æƒå½“æ˜¯è‡ªå·±åšä¸€ä¸‹è®°å½•ï¼Œè¯·è‡ªè¡Œå†³å®šå‚è€ƒã€‚</p>
<p>æœ¬æ–‡éƒ¨åˆ†å‚è€ƒï¼š<a href="http://uc-r.github.io/logistic_regression">UC Business Analytics R Programming Guide: Logistic Regression</a></p>
<div class="section level1">
<h1>æœ‰åºå’Œæ— åºå› å­å˜é‡</h1>
<p>äº‹å®ä¸Šä»¥å‰ï¼Œæˆ‘å¯¹è¿™ä¸ªé—®é¢˜æ²¡ä»€ä¹ˆç–‘é—®(å¤§æ¦‚æ˜¯æ— çŸ¥è€…æ— ç•å§ğŸ˜‚)ã€‚é¦–å…ˆåˆ†ç±»å˜é‡ï¼ˆcategorical variablesï¼‰ä¸€èˆ¬æˆ‘ä»¬éƒ½ä¼šç”¨å­—ç¬¦å‹ï¼ˆcharacterï¼‰æ¥å­˜å‚¨ï¼Œæ¯”å¦‚ç®€å•çš„ male/femaleã€single/married/widowed ç­‰ï¼Œè¿™ä¸ªå¤ªç›´è§‚äº†æ ¹æœ¬ä¸éœ€è¦è§£é‡Šå’Œæ€è€ƒã€‚å°±ç®—æœ‰æ—¶å€™æˆ‘ä»¬ä¼šæŠŠå®ƒä»¬ç”¨æ•°å­—è¡¨ç¤ºï¼Œæ¯”å¦‚æ€§åˆ«æ˜¯ 0/1ã€å©šå¦æ˜¯ 0/1 è¿™æ ·çš„äºŒåˆ†ç±»å˜é‡æˆ‘ä»¬ç”šè‡³å¯ä»¥ä¸€æ ·å­˜å‚¨ä¸º character å˜›ã€‚</p>
<p>ä½†æ˜¯ï¼Œæœ‰æ—¶å€™æœ‰çš„åˆ†ç±»å˜é‡çœ‹èµ·æ¥ â€œå¥½åƒæ˜¯æœ‰åºâ€ çš„æˆ‘å°±ä¼šæœ‰ç‚¹çŠ¯å˜€å’•äº†ã€‚æ¯”å¦‚è‚¿ç˜¤çš„åˆ†æœŸ â… /â…¡/â…¢/â…£ ã€å°¿è›‹ç™½ +/++/+++ è¿™æ ·çš„å˜é‡ã€‚è¿™äº›å˜é‡å¥½åƒæœ¬èº«æ˜¯æœ‰é¡ºåºçš„ï¼Œè€Œä¸”ä¸éµå¾ªè¿™ä¸ªæœ¬èº«è‡ªç”±é¡ºåºå¥½åƒä¹Ÿä¸å¤§åˆé€‚ã€‚æˆ‘ä»¥å‰å°±æ˜¯è¿™ä¹ˆä»¥ä¸ºçš„ã€‚</p>
<p>ç›´åˆ°æœ‰æ¬¡æˆ‘çœŸçš„åœ¨åšå›å½’çš„æ—¶å€™ç†æ‰€å½“ç„¶çš„æŠŠä¸€äº›å˜é‡è®¾ç½®æˆ ordered factor çš„æ—¶å€™ï¼Œå‘ç°ç»“æœä¼šå‡ºç°ä¸€äº›æ€ªæ€ªçš„æˆ‘ä¸çŸ¥é“æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œæ‰æ„è¯†åˆ°è¿™ä¸ªä¸œè¥¿å¹¶éè¿™ä¹ˆç®€å•ã€‚</p>
<p>ä¸‹é¢ç”¨ä¾‹å­å…·ä½“æ¥è¯´æ˜æƒ…å†µã€‚</p>
</div>
<div class="section level1">
<h1>ä¾‹å­</h1>
<p>ç”Ÿæˆ Logistic å›å½’æ¨¡æ‹Ÿæ•°æ®ï¼š</p>
<ul>
<li><a href="https://stats.stackexchange.com/questions/46523/how-to-simulate-artificial-data-for-logistic-regression">How to simulate artificial data for logistic regression?</a></li>
<li><a href="https://stats.stackexchange.com/questions/49916/simulating-data-for-logistic-regression-with-a-categorical-variable">Simulating data for logistic regression with a categorical variable</a></li>
</ul>
<p>é¦–å…ˆæˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªæ¨¡æ‹Ÿæ•°æ®ï¼Œæˆ‘ä»¬ x1ï½x4 å››ä¸ªå˜é‡çš„ 100 x 4 çš„æ•°æ®ä½œä¸ºå› å˜é‡ã€‚å…¶ä¸­ x1ã€x2 éƒ½æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œx3ã€x4 åˆ™æ˜¯åˆ†ç±»å˜é‡ä¸”äºŒè€…å®Œå…¨ç›¸åŒçš„å­—æ¯ Aï½E åªæ˜¯ x3 æ˜¯æœ‰åºå› å­è€Œ x4 æ˜¯æ— åºå› å­ï¼š</p>
<pre class="r"><code>library(&quot;dummies&quot;)
set.seed(1234)

n = 1000
x1 &lt;- rnorm(n = n, mean = 0, sd = 1)
x2 &lt;- rnorm(n = n, mean = 0, sd = 1)
x3 &lt;- factor(round(runif(n = n, min = 1, max = 5)),
             ordered = TRUE, labels = LETTERS[1:5])
x4 &lt;- factor(x3, ordered = FALSE, labels = letters[1:5])
table(x3)
## x3
##   A   B   C   D   E 
## 124 235 263 236 142
table(x4)
## x4
##   a   b   c   d   e 
## 124 235 263 236 142</code></pre>
<p>ç„¶åæˆ‘ä»¬æ ¹æ® Logit å˜æ¢æ¥æ„é€  yã€‚è¿™æ ·èƒ½ä¿è¯ y ï½ x ä¹‹é—´ç¬¦åˆ Logistic å›å½’æ¨¡å‹å¹¶ä¸”å›å½’ç³»æ•°æ˜¯æˆ‘ä»¬å·²çŸ¥çš„ï¼š</p>
<pre class="r"><code>beta0 &lt;- 1
betaB &lt;- -2
betaC &lt;- 3
betaD &lt;- -4
betaE &lt;- 5

linpred &lt;- cbind(x1, x2, 1, dummy(x4)[, -1]) %*%
  c(2, -3, beta0, betaB, betaC, betaD, betaE)
pi &lt;- exp(linpred) / (1 + exp(linpred))
y &lt;- rbinom(n = n, size = 1, prob = pi)
table(y)
## y
##   0   1 
## 424 576</code></pre>
<p>å¥½äº†ï¼Œx/y éƒ½æœ‰äº†ï¼Œæˆ‘ä»¬æ„é€ ä¸€ä¸ªæ•°æ®æŠŠä»–ä»¬éƒ½è£…èµ·æ¥ï¼š</p>
<pre class="r"><code>dat &lt;- data.frame(y, x1, x2, x3, x4)
head(dat)
##   y         x1         x2 x3 x4
## 1 1 -1.2070657 -1.2053334  B  b
## 2 0  0.2774292  0.3014667  D  d
## 3 1  1.0844412 -1.5391452  C  c
## 4 0 -2.3456977  0.6353707  D  d
## 5 1  0.4291247  0.7029518  C  c
## 6 1  0.5060559 -1.9058829  E  e
str(dat)
## &#39;data.frame&#39;:    1000 obs. of  5 variables:
##  $ y : int  1 0 1 0 1 1 1 0 1 0 ...
##  $ x1: num  -1.207 0.277 1.084 -2.346 0.429 ...
##  $ x2: num  -1.205 0.301 -1.539 0.635 0.703 ...
##  $ x3: Ord.factor w/ 5 levels &quot;A&quot;&lt;&quot;B&quot;&lt;&quot;C&quot;&lt;&quot;D&quot;&lt;..: 2 4 3 4 3 5 5 4 1 4 ...
##  $ x4: Factor w/ 5 levels &quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,..: 2 4 3 4 3 5 5 4 1 4 ...</code></pre>
<p>æ³¨æ„æœ€å str() å·²ç»å¾ˆæ˜ç¡®çš„æ˜¾ç¤º x3/x4 æ˜¯å¦ä¸º ordered factorã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å°±åˆ†åˆ«å»ºç«‹ä¸¤ä¸ª Logistic å›å½’æ–¹ç¨‹ï¼Œy ï½ x1 + x2 + x3 å’Œ y ï½ x1 + x2 + x4ã€‚è¿™ä¸¤ä¸ªå›å½’æ–¹ç¨‹çš„å”¯ä¸€ä¸åŒåº”è¯¥å°±åœ¨äºå…¶ä¸­ä¸€ä¸ªå˜é‡æ˜¯å¦è®¾ç½®ä¸º ordered factorã€‚</p>
<pre class="r"><code>fit.ord &lt;- glm(y ~ x1 + x2 + x3, 
               family = binomial(link = &quot;logit&quot;), 
               data = dat)
fit.unord &lt;- glm(y ~ x1 + x2 + x4, 
                 family = binomial(link = &quot;logit&quot;), 
                 data = dat)
summary(fit.ord)
## 
## Call:
## glm(formula = y ~ x1 + x2 + x3, family = binomial(link = &quot;logit&quot;), 
##     data = dat)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -3.15325  -0.20599   0.01831   0.27052   2.57849  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   1.5920     0.1727   9.217  &lt; 2e-16 ***
## x1            1.9862     0.1810  10.973  &lt; 2e-16 ***
## x2           -3.0160     0.2377 -12.688  &lt; 2e-16 ***
## x3.L          2.9623     0.4132   7.170 7.51e-13 ***
## x3.Q          2.5458     0.3891   6.543 6.04e-11 ***
## x3.C          3.3676     0.3364  10.012  &lt; 2e-16 ***
## x3^4          6.3865     0.4765  13.404  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1363.10  on 999  degrees of freedom
## Residual deviance:  450.36  on 993  degrees of freedom
## AIC: 464.36
## 
## Number of Fisher Scoring iterations: 7
summary(fit.unord)
## 
## Call:
## glm(formula = y ~ x1 + x2 + x4, family = binomial(link = &quot;logit&quot;), 
##     data = dat)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -3.15325  -0.20599   0.01831   0.27052   2.57849  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   0.7776     0.2714   2.865  0.00417 ** 
## x1            1.9862     0.1810  10.973  &lt; 2e-16 ***
## x2           -3.0160     0.2377 -12.688  &lt; 2e-16 ***
## x4b          -1.7263     0.3521  -4.903 9.41e-07 ***
## x4c           4.0335     0.4649   8.677  &lt; 2e-16 ***
## x4d          -4.1125     0.4536  -9.067  &lt; 2e-16 ***
## x4e           5.8769     0.6641   8.850  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1363.10  on 999  degrees of freedom
## Residual deviance:  450.36  on 993  degrees of freedom
## AIC: 464.36
## 
## Number of Fisher Scoring iterations: 7</code></pre>
</div>
<div class="section level1">
<h1>è§£è¯»</h1>
<p>é¦–å…ˆæˆ‘ä»¬çœ‹åˆ°ä¸¤ä¸ªæ¨¡å‹çš„ x1/x2 éƒ½æ˜¯æ˜¾è‘—çš„ä¸” p å€¼å®Œå…¨ç›¸åŒï¼Œæ¨¡å‹ AICã€æ®‹å·®å®Œå…¨ç›¸åŒã€‚ä½†æ˜¯å¾ˆå¥‡æ€ªçš„å°±æ˜¯åœ¨ <code>fit.ord</code> é‡Œé¢å…³äº x3 çš„ç»“æœæœ‰ x3.L/x3.Q/x3.C/x3^4 è¿™ä¹ˆå‡ ä¸ªå¥‡å¥‡æ€ªæ€ªçš„å˜é‡ï¼Œè€Œ <code>fit.unord</code> å°±æ¯”è¾ƒè®©äººå¥½ç†è§£åªæœ‰ x4b ~ x4eï¼Œè¡¨ç¤ºå®ƒä»¬å°† x4 = <code>a</code> ä½œä¸ºåŸºå‡†çš„ç»“æœã€‚</p>
<p>æŸ¥è¯¢äº†ä¸€ä¸‹æˆ‘çŸ¥é“ L/Q/C åˆ†åˆ«ä»£è¡¨ Linear/Quadratic/Cubicï¼Œå³çº¿æ€§ï¼ˆ1 æ¬¡æ–¹ï¼‰ã€å¹³æ–¹å’Œç«‹æ–¹ï¼Œæ‰€ä»¥æœ€åä¸€ä¸ªæ‰ä¼šå†™ x3^4 å³ 4 æ¬¡æ–¹ã€‚è¿™ä¸ªæ˜¯å¤šé¡¹å¼ï¼ˆPolynormialï¼‰æ¨¡å‹ï¼Œå³æŠŠ x3 ä» 1ï½4 æ¬¡æ–¹ï¼ˆx3 ä¸€å…±æ˜¯ 5 ä¸ªæ°´å¹³ï¼‰éƒ½çº³å…¥æ¨¡å‹ã€‚è‡³äºæ˜¯ä¸€èµ·çº³å…¥æ¨¡å‹è¿˜æ˜¯é€ä¸ªï¼Œæˆ‘è¿˜æ²¡ææ¸…æ¥šã€‚</p>
<p>å‡ºç°æ¨¡å‹ä¼šçº³å…¥å¤šé¡¹å¼ï¼Œæ˜¯ R åœ¨å›å½’åˆ†æä¸­åŒ…æ‹¬æœ‰åºå› å­å˜é‡æ—¶çš„ä¸€ç§è®¾ç½®ï¼š</p>
<pre class="r"><code>getOption(&quot;contrasts&quot;)
##         unordered           ordered 
## &quot;contr.treatment&quot;      &quot;contr.poly&quot;
contrasts(dat$x3) # ord
##              .L         .Q            .C         ^4
## [1,] -0.6324555  0.5345225 -3.162278e-01  0.1195229
## [2,] -0.3162278 -0.2672612  6.324555e-01 -0.4780914
## [3,]  0.0000000 -0.5345225 -4.095972e-16  0.7171372
## [4,]  0.3162278 -0.2672612 -6.324555e-01 -0.4780914
## [5,]  0.6324555  0.5345225  3.162278e-01  0.1195229
contrasts(dat$x4)  # un-ord
##   b c d e
## a 0 0 0 0
## b 1 0 0 0
## c 0 1 0 0
## d 0 0 1 0
## e 0 0 0 1</code></pre>
<p>æˆ‘ä»¬å¯ä»¥è‡ªå·±æ›´æ”¹è¿™ä¸ªé»˜è®¤çš„å‚æ•°ï¼š</p>
<pre class="r"><code># set contrast for ord.factor to contr.treatment
options(contrasts = c(&quot;contr.treatment&quot;, &quot;contr.treatment&quot;))
getOption(&quot;contrasts&quot;)
## [1] &quot;contr.treatment&quot; &quot;contr.treatment&quot;
fit.ord2 &lt;- glm(y ~ x1 + x2 + x3, family = binomial(link = &quot;logit&quot;), data = dat)
fit.unord2 &lt;- glm(y ~ x1 + x2 + x4, family = binomial(link = &quot;logit&quot;), data = dat)
summary(fit.ord2)
## 
## Call:
## glm(formula = y ~ x1 + x2 + x3, family = binomial(link = &quot;logit&quot;), 
##     data = dat)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -3.15325  -0.20599   0.01831   0.27052   2.57849  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   0.7776     0.2714   2.865  0.00417 ** 
## x1            1.9862     0.1810  10.973  &lt; 2e-16 ***
## x2           -3.0160     0.2377 -12.688  &lt; 2e-16 ***
## x3B          -1.7263     0.3521  -4.903 9.41e-07 ***
## x3C           4.0335     0.4649   8.677  &lt; 2e-16 ***
## x3D          -4.1125     0.4536  -9.067  &lt; 2e-16 ***
## x3E           5.8769     0.6641   8.850  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1363.10  on 999  degrees of freedom
## Residual deviance:  450.36  on 993  degrees of freedom
## AIC: 464.36
## 
## Number of Fisher Scoring iterations: 7
summary(fit.unord2) 
## 
## Call:
## glm(formula = y ~ x1 + x2 + x4, family = binomial(link = &quot;logit&quot;), 
##     data = dat)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -3.15325  -0.20599   0.01831   0.27052   2.57849  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   0.7776     0.2714   2.865  0.00417 ** 
## x1            1.9862     0.1810  10.973  &lt; 2e-16 ***
## x2           -3.0160     0.2377 -12.688  &lt; 2e-16 ***
## x4b          -1.7263     0.3521  -4.903 9.41e-07 ***
## x4c           4.0335     0.4649   8.677  &lt; 2e-16 ***
## x4d          -4.1125     0.4536  -9.067  &lt; 2e-16 ***
## x4e           5.8769     0.6641   8.850  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1363.10  on 999  degrees of freedom
## Residual deviance:  450.36  on 993  degrees of freedom
## AIC: 464.36
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç°åœ¨ä¸¤ä¸ªæ¨¡å‹éƒ½ä½¿ç”¨ <code>contr.treatment</code> ä½œä¸ºæ¯”è¾ƒçŸ©é˜µï¼Œè¿™æ ·å°±éƒ½æŠŠ x3/x4 = <code>a</code> ä½œä¸ºåŸºå‡†æ¥è®¡ç®—ï¼Œæ‰€ä»¥æœ€åçš„ç»“æœå°±ä¸€æ¨¡ä¸€æ ·äº†ã€‚</p>
<p>è¿™é‡Œå¤§æ¦‚è¿˜è¦å†å¤šè¡¥ç»Ÿè®¡æ–¹é¢çš„è¯¾ã€‚ä»¥ä¸Šä¹Ÿå‚è€ƒäº†ä¸€äº›èµ„æ–™ï¼š</p>
<p>ä¸€ç³»åˆ— stack ä¸Šæœåˆ°çš„é—®é¢˜ï¼š</p>
<ul>
<li><a href="https://stats.stackexchange.com/questions/175305/factor-or-ordered-factor">Factor or ordered factor?</a></li>
<li><a href="https://stats.stackexchange.com/questions/233455/interpretation-of-l-q-output-from-a-negative-binomial-glm-with-categorical-d">Interpretation of .L &amp; .Q output from a negative binomial GLM with categorical data</a></li>
<li><a href="https://stats.stackexchange.com/questions/101511/logistic-regression-and-ordinal-independent-variables/101556#comment197321_101513">Logistic regression and ordinal independent variables</a></li>
<li><a href="https://stats.stackexchange.com/questions/5387/logit-with-ordinal-independent-variables">Logit with ordinal independent variables</a></li>
<li><a href="https://stats.stackexchange.com/questions/195246/how-to-handle-ordinal-categorical-variable-as-independent-variable">How to handle ordinal categorical variable as independent variable</a></li>
<li><a href="https://stackoverflow.com/questions/21585056/is-there-an-advantage-to-ordering-a-categorical-variable">Is there an advantage to ordering a categorical variable?</a></li>
<li><a href="https://stackoverflow.com/questions/23396591/factors-ordered-vs-levels">Factors ordered vs.Â levels</a></li>
</ul>
<p>R é‚®ä»¶åˆ—è¡¨å’Œæ–‡æ¡£ï¼š</p>
<ul>
<li><a href="http://r.789695.n4.nabble.com/Models-with-ordered-and-unordered-factors-td4072225.html">r-help maillist: Models with ordered and unordered factors</a></li>
<li><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/contrasts.html">R-Manual: Get and Set Contrast Matrices</a></li>
</ul>
<p>å¦å¤–åœ¨ç½‘ä¸Šçœ‹åˆ°çš„ä¸¤ç¯‡å¾ˆå¥½çš„åšæ–‡ï¼š</p>
<ul>
<li><a href="https://freakonometrics.hypotheses.org/9023">LOGISTIC REGRESSION AND CATEGORICAL COVARIATES</a></li>
<li><a href="https://freakonometrics.hypotheses.org/9109">REGRESSION ON VARIABLES, OR ON CATEGORIES?</a></li>
</ul>
</div>
<div class="section level1">
<h1>æ¨¡å‹è¯„ä»·å’Œæ¯”è¾ƒ</h1>
<p>ä¸‹é¢å†æ¥çœ‹æ¨¡å‹æ¯”è¾ƒã€‚</p>
<p>æœ‰æ—¶å€™æˆ‘ä»¬çº³å…¥éå¸¸å¤šçš„å˜é‡ï¼Œç„¶ååšä¸€ä¸ªå›å½’å‘ç°å¾ˆå¤šå˜é‡éƒ½å¹¶ä¸æ˜¾è‘—ï¼Œè¿™æ—¶å€™å°±ä¼šæ¶‰åŠåˆ°å˜é‡ç­›é€‰ã€‚å¸¸è§çš„åšæ³•æ˜¯æ ¹æ® AIC/BIC åš stepwise ç­›é€‰ã€‚è¿™é‡Œå°±ä¸ä»‹ç»å„ç§æ–¹æ³•åŠå…¶ä¼˜åŠ£äº†ï¼Œè¿™ä¸ªæ˜¯å¦ä¸€ä¸ªè¯é¢˜ã€‚</p>
<p>æ™®é€šçš„çº¿æ€§æ¨¡å‹é‡Œï¼Œä¸€èˆ¬ç›´æ¥ç”¨ F æ£€éªŒçœ‹æ¨¡å‹æ˜¯å¦æ˜¾è‘—ã€<span class="math inline">\(R^2\)</span>/Adj <span class="math inline">\(R^2\)</span> æ¥çœ‹æ¨¡å‹æ•ˆæœï¼Œåœ¨ Logistic æ¨¡å‹é‡Œï¼Œæœ‰ä¸€äº›ç±»ä¼¼çš„ä¸œè¥¿ã€‚è¿™å±äºæ¨¡å‹çš„ goodness of fitï¼Œå³æ¨¡å‹æœ¬èº«çš„æ‹Ÿåˆç¨‹åº¦ã€‚ä¸€èˆ¬æ˜¯åœ¨æ¨¡å‹ä¹‹é—´ã€æ¨¡å‹ä¸æ— æ•ˆæ¨¡å‹çš„æ¯”è¾ƒä¸Šæ¥è¯´ã€‚</p>
<p>æˆ‘ä»¬ç›´æ¥çœ‹å¦‚æœç°åœ¨æˆ‘åˆåšä¸€ä¸ªç®€åŒ–æ¨¡å‹ï¼Œä»¥åŠè¿˜æœ‰æ— æ•ˆæ¨¡å‹ä¸€èµ·ï¼Œå¦‚ä½•æ¯”è¾ƒæ¨¡å‹æ˜¯ä¸æ˜¯çœŸçš„æ¯”ä¹‹å‰è¦å¥½ã€‚</p>
<pre class="r"><code>fit.ord.reduced &lt;- glm(y ~ x1 + x2, family = binomial(), data = dat)
fit.null &lt;- glm(y ~ 1, family = binomial(), data = dat)
summary(fit.ord.reduced)
## 
## Call:
## glm(formula = y ~ x1 + x2, family = binomial(), data = dat)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.6009  -0.9581   0.4435   0.8925   2.0253  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.44262    0.07502   5.900 3.64e-09 ***
## x1           0.75437    0.08289   9.101  &lt; 2e-16 ***
## x2          -1.12694    0.09225 -12.216  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1363.1  on 999  degrees of freedom
## Residual deviance: 1095.4  on 997  degrees of freedom
## AIC: 1101.4
## 
## Number of Fisher Scoring iterations: 4
summary(fit.null)
## 
## Call:
## glm(formula = y ~ 1, family = binomial(), data = dat)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
##  -1.31   -1.31    1.05    1.05    1.05  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.30637    0.06399   4.788 1.69e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1363.1  on 999  degrees of freedom
## Residual deviance: 1363.1  on 999  degrees of freedom
## AIC: 1365.1
## 
## Number of Fisher Scoring iterations: 4
with(fit.ord.reduced, 
     pchisq(null.deviance - deviance, 
            df.null - df.residual, lower.tail = FALSE))
## [1] 7.508523e-59
with(fit.ord, 
     pchisq(null.deviance - deviance, 
            df.null - df.residual, lower.tail = FALSE))
## [1] 6.622618e-194
vcdExtra::LRstats(vcdExtra::glmlist(fit.ord2, fit.ord.reduced, fit.null))
## Likelihood summary table:
##                     AIC     BIC LR Chisq  Df Pr(&gt;Chisq)    
## fit.ord2         464.36  498.72   450.36 993    1.00000    
## fit.ord.reduced 1101.43 1116.15  1095.43 997    0.01576 *  
## fit.null        1365.10 1370.01  1363.10 999  1.076e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
anova(fit.ord, fit.ord.reduced, test = &#39;Chisq&#39;)
## Analysis of Deviance Table
## 
## Model 1: y ~ x1 + x2 + x3
## Model 2: y ~ x1 + x2
##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
## 1       993     450.36                          
## 2       997    1095.43 -4  -645.06 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>ç±»æ¯”æ™®é€šçº¿æ€§æ¨¡å‹çš„ F æ£€éªŒï¼Œå¡æ–¹æ£€éªŒæ˜¾ç¤º <code>fit.ord</code> å’Œ <code>fit.ord.reduced</code> è¿™ä¸¤ä¸ªæ¨¡å‹ä¹‹é—´æœ‰æ˜¾è‘—å·®åˆ«ã€‚ç”±äºç®€åŒ–æ¨¡å‹ AIC å˜å¤§äº†ï¼Œæ‰€ä»¥ç»“è®ºå°±æ˜¯å…¶å®ç®€åŒ–æ¨¡å‹ç›¸æ¯”åŸæ¥çš„æ¨¡å‹æ›´å·®äº†ã€‚ï¼ˆå…¶å®è¿˜å¯ä»¥çœ‹åˆ°ï¼ŒAIC å’Œ BIC ä¸€ä¸ªæ˜¯å˜å¤§ä¸€ä¸ªæ˜¯å˜å°çš„ï¼‰</p>
<p>è¿˜æœ‰å¦å¤–ä¸€ä¸ªç±»ä¼¼äº <span class="math inline">\(R^2\)</span> çš„ç»Ÿè®¡é‡ä¹Ÿå¯ä»¥ç”¨æ¥è¡¡é‡æ¨¡å‹çš„ goodness of fitï¼š</p>
<pre class="r"><code>c(model.ord = pscl::pR2(fit.ord)[&quot;McFadden&quot;],   # Pseudo R^2,  higher is better
  model.unord = pscl::pR2(fit.unord)[&quot;McFadden&quot;],
  model.ord.reduced = pscl::pR2(fit.ord.reduced)[&quot;McFadden&quot;])
##         model.ord.McFadden       model.unord.McFadden 
##                  0.6696041                  0.6696041 
## model.ord.reduced.McFadden 
##                  0.1963707</code></pre>
<p>McFaddenâ€™s Pseudo <span class="math inline">\(R^2\)</span> é€šå¸¸ä¸ä¼šå¾ˆå¤§ï¼Œ0.2 ï½ 0.4 ä¹‹é—´å·²ç»è¡¨ç¤ºæ¨¡å‹å…·æœ‰å¾ˆå¥½çš„æ‹Ÿåˆåº¦äº†ã€‚</p>
</div>
<div class="section level1">
<h1>ç»“è¯­</h1>
<p>è¿™ç¯‡å°±å†™è¿™ä¹ˆå¤šå§ã€‚å…¶å®è¿™ä¸€ç¯‡ä¸»è¦æ˜¯å°†ç›®å‰çš„ä¸€ç‚¹ç–‘æƒ‘å†™ä¸‹æ¥ä»¥å¾…è§£å†³ã€‚æš‚æ—¶çš„æ–¹æ³•è¿˜æ˜¯åœ¨åšå› å­å‹æ•°æ®çš„æ—¶å€™ï¼Œå…ˆé€‰æ‹©ä»¥æ— åºçº³å…¥åˆ†æï¼Œæˆ–è€…æ”¹å˜æ¯”è¾ƒçŸ©é˜µå‚æ•°ã€‚</p>
<p>æœ¬ç¯‡ä»£ç è„šæœ¬ï¼š<a href="code/2019-03-05-r-ordered-unordered-factors_files/ordered.unordered.factors.R">ordered.unordered.factors.R</a>ã€‚</p>
</div>

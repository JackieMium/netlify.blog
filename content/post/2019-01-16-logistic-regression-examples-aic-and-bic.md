---
title:  Logistic å›å½’ä¸­ AIC å’Œ BIC ç”¨äºå˜é‡ç­›é€‰
author: Jackie
date: '2019-01-16'
slug: logistic-regression-examples-aic-and-bic
categories:
  - Stats
tags:
  - R
  - stats
disable_comments: no
show_toc: yes
---

>*All models are wrong, but some are useful*.  -- George Box


æœ€è¿‘å¤„ç†æ•°æ®å‘ç°ç»Ÿè®¡å­¦çŸ¥è¯†å¤ªä¸å¤Ÿç”¨äº†ï¼Œä»¥å‰ä¸Šçš„ç»Ÿè®¡å­¦åŸºæœ¬åªçŸ¥é“ *t* æ£€éªŒã€æ–¹å·®åˆ†æã€å¡æ–¹æ£€éªŒåŠ ä¸Šç®€å•çš„å›å½’å’Œç›¸å…³ã€ç”Ÿå­˜åˆ†æã€‚å¯¹äº Logistic å›å½’çŸ¥é“çš„åŸºæœ¬ä¸Šå°±æ˜¯æ€ä¹ˆåšçš„ *logit* å˜æ¢ã€å›å½’ç³»æ•° `$ \beta$ ` å’Œ OR çš„è”ç³»ã€æ€ä¹ˆè§£é‡Šçš„é—®é¢˜ã€‚å…·ä½“çš„æ€ä¹ˆåšç”Ÿå­˜åˆ†æã€ Logistic å›å½’å®Œå…¨ä¸çŸ¥é“ã€‚ä½†æ˜¯å‘¢ï¼Œå®é™…åšæ•°æ®åˆ†æå‘ç°äºŒè€…å…¶å®ç®€ç›´ä¸è¦å¤ªå¸¸è§ã€‚æ‰€ä»¥ï¼Œåªèƒ½è‡ªå­¦äº†ã€‚

åœ¨ç½‘ä¸Šéšæ„æœæ‰¾åˆ°ä¸€ä¸ªå¾ˆä¸é”™çš„ææ–™ï¼Œä»‹ç»  Bayesian Model Averaging æ³•çš„ R åŒ… BMA ç”¨æ¥åšæ¨¡å‹é€‰æ‹©ï¼š[Model Selection in Linear Regression](http://staff.ustc.edu.cn/~zwp/teach/MVA/select.pdf) ï¼Œä¼¼ä¹æ˜¯ USTC æŸä½è€å¸ˆçš„æ•™æ¡ˆã€‚è¯•ç€é‡å¤äº†ä¸€ä¸‹é‡Œé¢çš„ç»“æœï¼Œå¤§è‡´è¿˜è¡Œã€‚è®°å½•å¹¶ä¸”ç®€å•ç¿»è¯‘ä¸€ä¸‹ã€‚

è®²ä¹‰ä¸€å…±æœ‰ 3 ä¸ªä¾‹å­ï¼Œå‰ä¸¤ä¸ªéƒ½æ˜¯æ¨¡æ‹Ÿæ•°æ®ï¼Œæ‰€ä»¥å…¶å®æˆ‘ä»¬æ˜¯çŸ¥é“çœŸå®æ¨¡å‹çš„ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥æ–¹ä¾¿çš„è¯„ä»·å¾—åˆ°çš„ç»“æœæ˜¯å¦å‡†ç¡®ï¼›ç¬¬ 3 ä¸ªä¹Ÿæ˜¯æœ€åä¸€ä¸ªæ¨¡å‹æ˜¯çœŸå®æ•°æ®ï¼ˆä½ä½“é‡å„¿æ•°æ®é›†ï¼‰ã€‚

## Example 1: Large number of covariates, null model is true

ç¬¬ä¸€ä¸ªä¾‹å­ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œæ•°æ®æœ‰ 30 ä¸ªè‡ªå˜é‡ x 1000 ä¸ªè§‚æµ‹ï¼Œä½†æ‰€æœ‰è‡ªå˜é‡éƒ½ä¸å› å˜é‡æ— å…³ï¼Œå³ null model ä¸ºçœŸã€‚æˆ‘ä»¬é€šè¿‡è¿™ä¸ªä¾‹å­æ¯”è¾ƒ AIC å’Œ BIC åœ¨çœŸå®æ¨¡å‹å¾ˆå°ï¼ˆæˆ–ç®€å•ï¼‰çš„æ—¶å€™çš„è¡¨ç°ã€‚

é¦–å…ˆæˆ‘ä»¬éšæœºç”Ÿæˆ 15 ä¸ªäºŒåˆ†ç±»å˜é‡ x1 ï½ x15ï¼Œæ¯ä¸ªå˜é‡éƒ½æœ‰ä¸åŒæ¯”ä¾‹çš„ 0/1 ã€‚

```r
library("BMA")

rates <- round(seq(.1, .9, length.out=15), 2)

set.seed(1234)
x1 <- rbinom(1000, 1, rates[1])
x2 <- rbinom(1000, 1, rates[2])
x3 <- rbinom(1000, 1, rates[3])
x4 <- rbinom(1000, 1, rates[4])
x5 <- rbinom(1000, 1, rates[5])
x6 <- rbinom(1000, 1, rates[6])
x7 <- rbinom(1000, 1, rates[7])
x8 <- rbinom(1000, 1, rates[8])
x9 <- rbinom(1000, 1, rates[9])
x10 <- rbinom(1000, 1, rates[10])
x11 <- rbinom(1000, 1, rates[11])
x12 <- rbinom(1000, 1, rates[12])
x13 <- rbinom(1000, 1, rates[13])
x14 <- rbinom(1000, 1, rates[14])
x15 <- rbinom(1000, 1, rates[15])
```

ç„¶åæ˜¯ 15 ä¸ªéšæœºçš„æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼ˆå‡æ•°ä¸º 0, æ ‡å‡†å·®ä¸º 1ï¼‰çš„è¿ç»­å‹å˜é‡ x16 ï½ x30ï¼š

```r
x16 <- rnorm(1000)
x17 <- rnorm(1000)
x18 <- rnorm(1000)
x19 <- rnorm(1000)
x20 <- rnorm(1000)
x21 <- rnorm(1000)
x22 <- rnorm(1000)
x23 <- rnorm(1000)
x24 <- rnorm(1000)
x25 <- rnorm(1000)
x26 <- rnorm(1000)
x27 <- rnorm(1000)
x28 <- rnorm(1000)
x29 <- rnorm(1000)
```

ä»¥åŠå› å˜é‡ y ä¸ºéšæœºçš„ 0/1 å„å ä¸€åŠï¼š

```r
y <- rbinom(1000, 1, 0.5)
```

æå®šäº†ï¼Œç°åœ¨å°±ç›´æ¥æŠŠæ•°æ®åˆèµ·æ¥å°±è¡Œäº†ï¼š

```r
example1.dat <- data.frame(y, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10,
                           x11, x12, x13, x14, x15, x16, x17, x18, x19, x20,
                           x21, x22, x23, x24, x25, x26, x27, x28, x29, x30)
names(example1.dat)
#  [1] "y"   "x1"  "x2"  "x3"  "x4"  "x5"  "x6"  "x7"  "x8"  "x9"  "x10" "x11" "x12"
# [14] "x13" "x14" "x15" "x16" "x17" "x18" "x19" "x20" "x21" "x22" "x23" "x24" "x25"
# [27] "x26" "x27" "x28" "x29" "x30"

head(example1.dat)
#   y x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 x13 x14 x15     x16      x17      x18
# 1 1  0  0  0  1  0  0  0  0  1   1   1   1   1   1   1 -0.9153  0.18906  0.56731
# 2 1  0  0  0  0  1  0  0  1  1   1   1   1   1   1   1 -1.0493  1.05886 -1.17934
# 3 1  0  0  0  0  0  1  1  0  1   1   1   1   1   1   1 -0.1702  1.50806  0.17732
# 4 0  0  0  0  0  0  1  0  1  0   1   0   1   0   1   1 -0.9573 -0.02743  0.09387
# 5 1  0  0  0  0  0  0  1  1  1   0   1   1   1   1   1 -0.4233  0.90592  0.37780
# 6 0  0  0  0  0  1  1  1  1  0   0   1   1   0   1   1 -0.2224  1.25207  0.67417
#        x19      x20     x21     x22     x23     x24     x25     x26      x27
# 1  0.05605  0.04794 -0.7579 -0.8885 -3.0130  0.2757 -0.9264 -1.0521 -1.95695
# 2 -0.01062  0.68691 -2.0385  0.5615 -0.6655  0.4172  0.2077 -0.7733 -0.28024
# 3 -0.20261  0.04087  0.3963 -0.0361  1.0232  0.3932  0.3591  0.9562 -1.42667
# 4 -1.01466 -0.12076  0.5976 -1.1644 -1.4597 -1.6077 -1.1000 -0.5926 -0.78517
# 5  0.37537  1.11574 -0.3029  1.0581 -0.4303  0.8402 -0.5158  0.8154 -0.02503
# 6  0.80737 -0.24688 -0.8890  0.8670 -0.6931  0.1868  0.7015 -1.5567  0.54382
#       x28     x29      x30
# 1  0.1325 -0.7575 -0.30341
# 2  0.2063  2.0019 -1.07430
# 3 -1.3397 -2.2955  0.40950
# 4 -1.2289 -0.7128 -0.48585
# 5  0.8574 -0.2103 -1.42814
# 6  1.0331  0.4169  0.03321
```

ä¸‹é¢å°±å¯ä»¥ç”¨ BMA åŒ…çš„ `bic.glm` å¼€å§‹åˆ†æäº†ã€‚å†æ¬¡æé†’ä¸€ä¸‹ï¼Œè¿™ä¸ªæ•°æ®é‡Œ null model ä¸ºçœŸï¼

å‘½ä»¤å½¢å¼ä¸ºï¼š

```r
bic.glm(f, data, glm.family, wt = rep(1, nrow(data)),
    strict = FALSE, prior.param = c(rep(0.5, ncol(x))), OR = 20, 
    maxCol = 30, OR.fix = 2, nbest = 150, dispersion = NULL, 
    factor.type = TRUE, factor.prior.adjust = FALSE, 
    occam.window = TRUE, ...)
```

å…¶å®å¥½å¤šå‚æ•°æˆ‘æ˜¯æ ¹æœ¬ä¸æ‡‚çš„ï¼Œå…·ä½“çš„è¿˜å¾—çœ‹ `?bic.glm`ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘è¦è¡¥ä¹ ç»Ÿè®¡çš„åœ°æ–¹...

è¡Œå§ï¼Œå…ˆç›´æ¥è·‘å§ï¼š

```r
fml <- as.formula(paste0("y ~", 
                         paste(names(example1.dat[, -y]), collapse = ' + ')))
output1 <- bic.glm(fml, glm.family = "binomial",
                   data = example1.dat, maxCol = 31)
summary(output1)
```

è¾“å‡ºå®åœ¨å¤ªé•¿ï¼Œæ”¾å›¾ç‰‡å§ï¼š

![summary_output1](/post/2019-01-16-logistic-regression-examples-aic-and-bic_files/1.summary_output1.png)

ä»ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œä»é€‰å‡ºçš„ 8 ä¸ªæ¨¡å‹é‡Œæœ€ä½³çš„ 5 ä¸ªæ¨¡å‹ä¸­ï¼Œnull model ç¡®å®æ’åœ¨ç¬¬ä¸€ä½ã€‚åéªŒæ¦‚ç‡ 0.478ã€‚è€Œæ’åœ¨åé¢çš„å‡ ä¸ªæ¨¡å‹åéªŒæ¦‚ç‡éƒ½è¦å°å¾—å¤šã€‚

æˆ‘ä»¬å†çœ‹çœ‹å…¶ä»–çš„è¾“å‡ºï¼Œ8 ä¸ªæ¨¡å‹çš„åéªŒæ¦‚ç‡å’ŒåŒ…å«çš„å˜é‡ï¼š

```r
output1$postprob
# [1] 0.47782 0.21993 0.12541 0.05956 0.03011 0.02977 0.02920 0.02821

output1$label
# [1] "NULL"        "x13.x"       "x24.x"       "x13.x,x24.x" "x28.x"       "x17.x"       "x15.x"       "x6.x" 
```

å¯¹äºæ‰€æœ‰å˜é‡æ¥è¯´ï¼Œæ¯ä¸ªå˜é‡åº”è¯¥åŒ…å«åœ¨æ¨¡å‹é‡Œçš„å¯èƒ½æ€§ï¼š

```r
output1$probne0
 #  x1   x2   x3   x4   x5   x6   x7   x8   x9  x10  x11  x12  x13  x14  x15  x16 
 # 0.0  0.0  0.0  0.0  0.0  2.8  0.0  0.0  0.0  0.0  0.0  0.0 27.9  0.0  2.9  0.0 
 # x17  x18  x19  x20  x21  x22  x23  x24  x25  x26  x27  x28  x29  x30 
 # 3.0  0.0  0.0  0.0  0.0  0.0  0.0 18.5  0.0  0.0  0.0  3.0  0.0  0.0 
```

x13 ç«Ÿç„¶ç¥å¥‡çš„è¾¾åˆ°äº† 27.9%ï¼Œx24 ä¹Ÿæœ‰ 18.5ï¼Œè€ŒåŸæ–‡è¿™é‡Œæœ€é«˜çš„ä¹Ÿåªæœ‰ 15.1%ã€‚

```r
xtabs(~y + x13, data = example1.dat)
#    x13
# y     0   1
#   0 119 367
#   1  95 419
chisq.test(xtabs(~y + x13))
# 
# 	Pearson's Chi-squared test with Yates' continuity correction
# 
# data:  xtabs(~y + x13)
# X-squared = 5, df = 1, p-value = 0.03


t.test(x24 ~ y, data = example1.dat, var.equal = TRUE)
# 
# 	Two Sample t-test
# 
# data:  x24 by y
# t = -2.1, df = 1000, p-value = 0.04
# alternative hypothesis: true difference in means is not equal to 0
# 95 percent confidence interval:
#  -0.252496 -0.005981
# sample estimates:
# mean in group 0 mean in group 1 
#        -0.11523         0.01401 

fit.2 <- glm(y ~ x13 + x24, data = example1.dat, family = binomial())
# summary(fit.2)
# Call:
# glm(formula = y ~ x13 + x24, family = binomial(), data = example1.dat)
# 
# Deviance Residuals: 
#    Min      1Q  Median      3Q     Max  
#  -1.37   -1.20    1.03    1.14    1.38  
# 
# Coefficients:
#             Estimate Std. Error z value Pr(>|z|)  
# (Intercept)  -0.2209     0.1379   -1.60    0.109  
# x13           0.3607     0.1554    2.32    0.020 *
# x24           0.1326     0.0642    2.07    0.039 *
# ---
# Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
# 
# (Dispersion parameter for binomial family taken to be 1)
# 
#     Null deviance: 1385.5  on 999  degrees of freedom
# Residual deviance: 1375.9  on 997  degrees of freedom
# AIC: 1382
# 
# Number of Fisher Scoring iterations: 3

1 - pchisq(1385.5-1375.9, 999 - 997, lower.tail = FALSE)
# [1] 0.99

anova(fit.2, test = 'Chisq')
# Analysis of Deviance Table
# 
# Model: binomial, link: logit
# 
# Response: y
# 
# Terms added sequentially (first to last)
# 
# 
#      Df Deviance Resid. Df Resid. Dev Pr(>Chi)  
# NULL                   999       1386           
# x13   1     5.36       998       1380    0.021 *
# x24   1     4.30       997       1376    0.038 *
# ---
# Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
```

è¿™å°±å°´å°¬äº†ï¼Œåªå«æœ‰ x13 å’Œ x24 çš„æ¨¡å‹æ€ä¹ˆåˆ†ææ¥çœ‹éƒ½æ˜¯æˆç«‹çš„ï¼Œåªèƒ½è¯´æ˜¯å¤©æ„å§ ğŸ˜‚

è´å¶æ¾æ¨¡å‹å¹³å‡å€¼å’Œæ ‡å‡†å·®ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“å…·ä½“çš„æ„ä¹‰ğŸ¤¦ï¼‰ï¼š

```r
output1$postmean
# (Intercept)          x1          x2          x3          x4          x5          x6 
#   -0.029711    0.000000    0.000000    0.000000    0.000000    0.000000    0.004100 
#          x7          x8          x9         x10         x11         x12         x13 
#    0.000000    0.000000    0.000000    0.000000    0.000000    0.000000    0.100163 
#         x14         x15         x16         x17         x18         x19         x20 
#    0.000000    0.007204    0.000000    0.002262    0.000000    0.000000    0.000000 
#         x21         x22         x23         x24         x25         x26         x27 
#    0.000000    0.000000    0.000000    0.024373    0.000000    0.000000    0.000000 
#         x28         x29         x30 
#   -0.002326    0.000000    0.000000 
output1$postsd
#  [1] 0.15977 0.00000 0.00000 0.00000 0.00000 0.00000 0.03251 0.00000 0.00000 0.00000
# [11] 0.00000 0.00000 0.00000 0.18053 0.00000 0.05550 0.00000 0.01714 0.00000 0.00000
# [21] 0.00000 0.00000 0.00000 0.00000 0.05811 0.00000 0.00000 0.00000 0.01746 0.00000
# [31] 0.00000
```

ä»¥åŠæ‰€æœ‰æ¨¡å‹çš„ä¼°è®¡å€¼åŠå…¶æ ‡å‡†è¯¯ï¼š

```r
output1$mle
#      (Intercept) x1 x2 x3 x4 x5     x6 x7 x8 x9 x10 x11 x12    x13 x14    x15 x16
# [1,]   5.601e-02  0  0  0  0  0 0.0000  0  0  0   0   0   0 0.0000   0 0.0000   0
# [2,]  -2.252e-01  0  0  0  0  0 0.0000  0  0  0   0   0   0 0.3578   0 0.0000   0
# [3,]   6.266e-02  0  0  0  0  0 0.0000  0  0  0   0   0   0 0.0000   0 0.0000   0
# [4,]  -2.209e-01  0  0  0  0  0 0.0000  0  0  0   0   0   0 0.3607   0 0.0000   0
# [5,]   5.451e-02  0  0  0  0  0 0.0000  0  0  0   0   0   0 0.0000   0 0.0000   0
# [6,]   5.358e-02  0  0  0  0  0 0.0000  0  0  0   0   0   0 0.0000   0 0.0000   0
# [7,]  -1.671e-01  0  0  0  0  0 0.0000  0  0  0   0   0   0 0.0000   0 0.2467   0
# [8,]   1.350e-16  0  0  0  0  0 0.1453  0  0  0   0   0   0 0.0000   0 0.0000   0
#        x17 x18 x19 x20 x21 x22 x23    x24 x25 x26 x27      x28 x29 x30
# [1,] 0.000   0   0   0   0   0   0 0.0000   0   0   0  0.00000   0   0
# [2,] 0.000   0   0   0   0   0   0 0.0000   0   0   0  0.00000   0   0
# [3,] 0.000   0   0   0   0   0   0 0.1314   0   0   0  0.00000   0   0
# [4,] 0.000   0   0   0   0   0   0 0.1326   0   0   0  0.00000   0   0
# [5,] 0.000   0   0   0   0   0   0 0.0000   0   0   0 -0.07724   0   0
# [6,] 0.076   0   0   0   0   0   0 0.0000   0   0   0  0.00000   0   0
# [7,] 0.000   0   0   0   0   0   0 0.0000   0   0   0  0.00000   0   0
# [8,] 0.000 

output1$se
#         [,1] [,2] [,3] [,4] [,5] [,6]   [,7] [,8] [,9] [,10] [,11] [,12] [,13]
# [1,] 0.06327    0    0    0    0    0 0.0000    0    0     0     0     0     0
# [2,] 0.13758    0    0    0    0    0 0.0000    0    0     0     0     0     0
# [3,] 0.06349    0    0    0    0    0 0.0000    0    0     0     0     0     0
# [4,] 0.13792    0    0    0    0    0 0.0000    0    0     0     0     0     0
# [5,] 0.06333    0    0    0    0    0 0.0000    0    0     0     0     0     0
# [6,] 0.06335    0    0    0    0    0 0.0000    0    0     0     0     0     0
# [7,] 0.20484    0    0    0    0    0 0.0000    0    0     0     0     0     0
# [8,] 0.08071    0    0    0    0    0 0.1301    0    0     0     0     0     0
#       [,14] [,15]  [,16] [,17]   [,18] [,19] [,20] [,21] [,22] [,23] [,24]   [,25]
# [1,] 0.0000     0 0.0000     0 0.00000     0     0     0     0     0     0 0.00000
# [2,] 0.1551     0 0.0000     0 0.00000     0     0     0     0     0     0 0.00000
# [3,] 0.0000     0 0.0000     0 0.00000     0     0     0     0     0     0 0.06404
# [4,] 0.1554     0 0.0000     0 0.00000     0     0     0     0     0     0 0.06416
# [5,] 0.0000     0 0.0000     0 0.00000     0     0     0     0     0     0 0.00000
# [6,] 0.0000     0 0.0000     0 0.06533     0     0     0     0     0     0 0.00000
# [7,] 0.0000     0 0.2154     0 0.00000     0     0     0     0     0     0 0.00000
# [8,] 0.0000     0 0.0000     0 0.00000     0     0     0     0     0     0 0.00000
#      [,26] [,27] [,28]   [,29] [,30] [,31]
# [1,]     0     0     0 0.00000     0     0
# [2,]     0     0     0 0.00000     0     0
# [3,]     0     0     0 0.00000     0     0
# [4,]     0     0     0 0.00000     0     0
# [5,]     0     0     0 0.06584     0     0
# [6,]     0     0     0 0.00000     0     0
# [7,]     0     0     0 0.00000     0     0
# [8,]     0     0     0 0.00000     0     0
```

å¯ä»¥é€šè¿‡æ¯”è¾ƒè¿™ä¸ªè¡¨æ ¼é‡Œæ¨¡å‹é—´ä¼°è®¡å€¼çš„ä¸åŒæ¥é‰´å®šæœ‰æ²¡æœ‰æ··æ‚å› ç´ å’Œå…±çº¿æ€§ä¹‹ç±»çš„ã€‚

æœ€åæ¥çœ‹çœ‹æ¨¡å‹çš„å¯è§†åŒ– `imageplot.bma(output1)`ï¼š

![2. models](/post/2019-01-16-logistic-regression-examples-aic-and-bic_files/2. models.png)

å›¾ä¸­çº¢è‰²è¡¨ç¤ºç³»æ•°ä¸ºæ­£ï¼Œè“è‰²ä¸ºè´Ÿã€‚

ä¸ç®¡æ€ä¹ˆæ ·ï¼ŒBIC æ€»ä½“è¡¨ç°è¿˜è¡Œå§ï¼Œè‡³å°‘æœ€ä¼˜æ¨¡å‹ç¡®å®æ˜¯ null å˜›ã€‚ä¸‹é¢å†çœ‹ AIC çš„æƒ…å†µï¼š

```r
output1.aic <- glm(fml, data = example1.dat, family = binomial(link = 'logit'))
summary(output1.aic)

# Call:
# glm(formula = fml, family = binomial(link = "logit"), data = example1.dat)
# 
# Deviance Residuals: 
#    Min      1Q  Median      3Q     Max  
#  -1.52   -1.19    0.94    1.13    1.49  
# 
# Coefficients:
#              Estimate Std. Error z value Pr(>|z|)  
# (Intercept) -0.444427   0.373099   -1.19    0.234  
# x1          -0.000796   0.200521    0.00    0.997  
# x2          -0.060975   0.188152   -0.32    0.746  
# x3          -0.005271   0.156950   -0.03    0.973  
# x4           0.141855   0.147306    0.96    0.336  
# x5          -0.103934   0.137558   -0.76    0.450  
# x6           0.136568   0.132909    1.03    0.304  
# x7           0.046675   0.130489    0.36    0.721  
# x8          -0.054424   0.129178   -0.42    0.674  
# x9           0.036636   0.130852    0.28    0.779  
# x10          0.073951   0.133445    0.55    0.579  
# x11         -0.026379   0.136114   -0.19    0.846  
# x12         -0.038997   0.146629   -0.27    0.790  
# x13          0.372992   0.157420    2.37    0.018 *
# x14         -0.118615   0.175837   -0.67    0.500  
# x15          0.283099   0.219810    1.29    0.198  
# x16         -0.019169   0.065982   -0.29    0.771  
# x17          0.076281   0.066948    1.14    0.255  
# x18          0.044459   0.065549    0.68    0.498  
# x19          0.013658   0.065620    0.21    0.835  
# x20          0.002741   0.063851    0.04    0.966  
# x21          0.010957   0.065941    0.17    0.868  
# x22         -0.030705   0.065102   -0.47    0.637  
# x23          0.040860   0.064653    0.63    0.527  
# x24          0.128399   0.065797    1.95    0.051 .
# x25         -0.019262   0.062303   -0.31    0.757  
# x26          0.050657   0.062493    0.81    0.418  
# x27         -0.012711   0.064273   -0.20    0.843  
# x28         -0.078285   0.067635   -1.16    0.247  
# x29          0.008709   0.066532    0.13    0.896  
# x30         -0.019270   0.064948   -0.30    0.767  
# ---
# Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
# 
# (Dispersion parameter for binomial family taken to be 1)
# 
#     Null deviance: 1385.5  on 999  degrees of freedom
# Residual deviance: 1365.8  on 969  degrees of freedom
# AIC: 1428
# 
# Number of Fisher Scoring iterations: 4
```

å¯ä»¥çœ‹åˆ° x13 ä»ç„¶å¾ˆæ˜¾è‘—ï¼Œx24 äº¤ç•Œæ€§ p å€¼ã€‚step ä¸€ä¸‹ï¼š

```r
step.aic1 <- step(output1.aic)
summary(step.aic1)
# 
# Call:
# glm(formula = y ~ x13 + x24, family = binomial(link = "logit"), 
#     data = example1.dat)
# 
# Deviance Residuals: 
#    Min      1Q  Median      3Q     Max  
#  -1.37   -1.20    1.03    1.14    1.38  
# 
# Coefficients:
#             Estimate Std. Error z value Pr(>|z|)  
# (Intercept)  -0.2209     0.1379   -1.60    0.109  
# x13           0.3607     0.1554    2.32    0.020 *
# x24           0.1326     0.0642    2.07    0.039 *
# ---
# Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
# 
# (Dispersion parameter for binomial family taken to be 1)
# 
#     Null deviance: 1385.5  on 999  degrees of freedom
# Residual deviance: 1375.9  on 997  degrees of freedom
# AIC: 1382
# 
# Number of Fisher Scoring iterations: 3
```

AIC æœ€ç»ˆé€‰å‡ºçš„æœ€ä½³æ¨¡å‹æ˜¯ x13 + x24ã€‚

**ç»“è®º**ï¼šæ‰€ä»¥æœ€ç»ˆæ¯”èµ·æ¥ï¼Œå½“â€œçœŸå®â€æ¨¡å‹å°æ—¶ï¼ŒAIC é€‰å‡ºçš„æ¨¡å‹å€¾å‘äºå«æœ‰æ›´å¤šå˜é‡ã€‚

## Example 2: Large number of covariates, some covariates are important

æ¥ä¸‹æ¥çš„ç¬¬äºŒä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬æœ‰ 500 ä¸ªè§‚æµ‹ * 20 ä¸ªå˜é‡ï¼Œå…¶ä¸­ 15/20 ä¸ªå˜é‡ä¸ y ç›¸å…³ã€‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­æ¥çœ‹çœ‹ AIC å’Œ BIC åœ¨å¤æ‚æ¨¡å‹æ—¶çš„è¡¨ç°ã€‚

```r
rates <- round(seq(.1, .9, length.out=15), 2)
rates

x1 <- rbinom(500, 1, rates[1])
x2 <- rbinom(500, 1, rates[2])
x3 <- rbinom(500, 1, rates[3])
x4 <- rbinom(500, 1, rates[4])
x5 <- rbinom(500, 1, rates[5])
x6 <- rbinom(500, 1, rates[6])
x7 <- rbinom(500, 1, rates[7])
x8 <- rbinom(500, 1, rates[8])
x9 <- rbinom(500, 1, rates[9])
x10 <- rbinom(500, 1, rates[10])

x11 <- rnorm(500)
x12 <- rnorm(500)
x13 <- rnorm(500)
x14 <- rnorm(500)
x15 <- rnorm(500)
x16 <- rnorm(500)
x17 <- rnorm(500)
x18 <- rnorm(500)
x19 <- rnorm(500)
x20 <- rnorm(500)

inv.logit.rate <- exp(x1 + x2 + x3 + x4 + x5 + x11 + x12 + x13 + x14 +x15) /
    (1 + exp(x1 + x2 + x3 + x4 + x5 + x11 + x12 + x13 + x14 +x15))
y <- rbinom(500, 1, inv.logit.rate)

example2.dat <- data.frame(y, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10,
                           x11, x12, x13, x14, x15, x16, x17, x18, x19, x20)
head(example2.dat)
#   y x1 x2 x3 x4 x5 x6 x7 x8 x9 x10     x11      x12     x13     x14     x15     x16
# 1 0  0  0  0  0  0  0  0  0  1   1  0.2655 -0.40082 -1.3337 -1.1223  0.1499 -0.4881
# 2 1  0  0  1  0  0  0  0  1  0   1 -1.2773  0.08673  0.2383  0.8506  0.5262  1.3041
# 3 1  0  0  0  0  0  0  1  0  1   0  1.4021 -0.90720  0.5285  0.1288  0.8158  0.7580
# 4 0  0  0  0  1  0  0  1  0  1   1  0.5292 -1.34385 -0.4030 -0.0991 -0.9883 -1.0909
# 5 0  0  0  1  1  0  1  1  0  0   1 -1.0983 -0.82387  0.5755 -0.6788  1.5165 -0.3535
# 6 1  0  0  0  1  0  1  1  0  1   1  2.0194 -0.55557 -0.3962  0.7169  1.0664 -0.7203
#       x17     x18     x19     x20
# 1 -0.5475 -0.2674 -0.5204 2.49182
# 2  0.4175  1.1291  0.2868 0.05322
# 3 -0.7084 -1.1273 -0.9832 0.45625
# 4 -1.8812  1.3935 -0.3154 1.57706
# 5  0.3680  0.7494 -0.2112 0.62235
# 6  1.4815  0.3092  1.2482 1.18798
```

ç„¶åä¸€æ ·çš„ï¼Œå…ˆçœ‹ BIC çš„æƒ…å†µï¼š

```r
fml <- as.formula(paste0("y ~",
                         paste(names(example2.dat[, -y]), collapse = ' + ')))
output2 <- bic.glm(fml, glm.family = "binomial",
                   data = example2.dat)
summary(output2)
```

![output2.summary](/post/2019-01-16-logistic-regression-examples-aic-and-bic_files/output2.summary.png)

```r
output2$probne0
#    x1    x2    x3    x4    x5    x6    x7    x8    x9   x10   x11   x12   x13
#  79.4  15.6 100.0  32.9  59.0   4.8   0.3   0.7  35.4   0.0 100.0 100.0 100.0
#   x14   x15   x16   x17   x18   x19   x20 
# 100.0 100.0   3.4  53.9   0.3   2.8   5.4 
output2$postmean
# (Intercept)          x1          x2          x3          x4          x5 
#   0.2608726   1.0646750   0.1182026   1.3977659   0.2345819   0.4301293 
#          x6          x7          x8          x9         x10         x11 
#   0.0182892   0.0004723  -0.0013515   0.2107023   0.0000000   1.0479031 
#         x12         x13         x14         x15         x16         x17 
#   1.0078711   0.9995036   1.0277983   0.9191281   0.0053290   0.1704792 
#         x18         x19         x20 
#   0.0002408   0.0041697  -0.0100352 
output2$postsd
#  [1] 0.287497 0.703087 0.319866 0.335013 0.382665 0.420385 0.101080 0.016729
#  [9] 0.026868 0.324285 0.000000 0.149255 0.149985 0.154967 0.157460 0.145704
# [17] 0.036354 0.182644 0.008583 0.033534 0.052486
output2$postsd/output2$postmean
# (Intercept)          x1          x2          x3          x4          x5 
#      1.1021      0.6604      2.7061      0.2397      1.6313      0.9773 
#          x6          x7          x8          x9         x10         x11 
#      5.5268     35.4244    -19.8798      1.5391         NaN      0.1424 
#         x12         x13         x14         x15         x16         x17 
#      0.1488      0.1550      0.1532      0.1585      6.8219      1.0714 
#         x18         x19         x20 
#     35.6471      8.0423     -5.2302 
```

å‰å‡ ä¸ªæ¨¡å‹å…¶å®éƒ½éå¸¸æ¥è¿‘ï¼Œå¹¶ä¸”å’Œâ€œçœŸå®â€æ¨¡å‹ä¹Ÿå¾ˆæ¥è¿‘äº†ã€‚ä½†æˆ‘çš„ç»“æœé‡Œæ‰€æœ‰æ¨¡å‹å‡ ä¹éƒ½æ²¡æœ‰çº³å…¥ x2ã€x4 å’Œ x6 ï½ x10ï¼Œè€ŒåŸæ–‡é‡Œä¸º x1ã€x3 å’Œ x5,åŸæ–‡è§£é‡Šå› ä¸ºè¿™ä¸‰ä¸ªå˜é‡é‡Œ 1 æ¯”ä¾‹å¤ªå°‘ï¼Œéš¾ä»¥å‘ç°ã€‚ä½†æ˜¯æˆ‘è¿™ä¸ª x6 ï½ x10 å…¶å®ç›¸æ¯”èµ·æ¥ 0/1 æ¯”ä¾‹å¾ˆæ¥è¿‘çš„ï¼Œæ‰€ä»¥åŸå› è¿˜ä¸åœ¨è¿™é‡Œã€‚çœ‹å‡æ•°å’Œæ ‡å‡†å·®ï¼Œå‘ç°è¿™å‡ ä¸ªå˜é‡çš„æ ‡å‡†å·®ç›¸å¯¹å‡æ•°æ¥è¯´éƒ½éƒ½å¥‡å¤§ï¼Œæ‰€ä»¥ç®—æ˜¯ç ´æ¡ˆäº†å§ã€‚ä»Šå¤©è¿æ°”ä¸å¥½ï¼Œéšæœºæ•°ç”Ÿæˆçš„å¥‡å¥‡æ€ªæ€ªçš„ï¼Œæ²¡åŠæ³•ã€‚

å¦å¤–ä»åéªŒæ¦‚ç‡æ¥çœ‹ï¼Œå¾ˆå¤šå˜é‡éƒ½è¾¾åˆ° 100%ï¼Œæ¨¡å‹è¡¨ç°ç®—æ˜¯å¾ˆå‡ºè‰²äº†ã€‚è€Œä¸”æˆ‘ä»¬è¿˜å¯ä»¥ï¼Œè¿ç»­æ€§å˜é‡ï¼ˆx11ï½x20ï¼‰å˜ç°æ™®éå¥½äºåˆ†ç±»å˜é‡ï¼ˆx1ï½x10ï¼‰ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¸¸è¯´çš„è¿ç»­æ€§æ•°æ®èƒ½åŒ…å«æ›´å¤šçš„ä¿¡æ¯ï¼ŒæŠŠè¿ç»­æ€§æ•°æ®è½¬æˆåˆ†ç±»æ•°æ®æŸå¤±æ•°æ®ä¿¡æ¯çš„æ„æ€ã€‚

æ€»çš„æ¥è¯´ BIC æ¨¡å‹è¡¨ç°è¿˜è¡Œï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æ‰¾åˆ°â€œçœŸå®â€çš„æ¨¡å‹ã€‚è¿™è¯´æ˜ BIC æ¨¡å‹æœ‰æ—¶å€™ä¼šåå°ã€‚

æˆ‘ä»¬å†æ¥çœ‹ AIC çš„è¡¨ç°ï¼š

```r
output2.aic <- glm(fml, data = example2.dat, family = "binomial")
summary(output2.aic)
# 
# Call:
# glm(formula = fml, family = "binomial", data = example2.dat)
# 
# Deviance Residuals: 
#    Min      1Q  Median      3Q     Max  
# -2.946  -0.424   0.195   0.565   2.925  
# 
# Coefficients:
#             Estimate Std. Error z value Pr(>|z|)    
# (Intercept)  -0.5304     0.3647   -1.45   0.1459    
# x1            1.4430     0.5267    2.74   0.0061 ** 
# x2            1.1011     0.4441    2.48   0.0132 *  
# x3            1.4722     0.3474    4.24  2.3e-05 ***
# x4            0.8851     0.3432    2.58   0.0099 ** 
# x5            0.7944     0.2965    2.68   0.0074 ** 
# x6            0.3805     0.2855    1.33   0.1826    
# x7            0.0703     0.2788    0.25   0.8008    
# x8           -0.1907     0.2793   -0.68   0.4948    
# x9            0.5860     0.2774    2.11   0.0347 *  
# x10           0.1488     0.2788    0.53   0.5935    
# x11           1.0633     0.1557    6.83  8.6e-12 ***
# x12           1.0856     0.1578    6.88  6.0e-12 ***
# x13           1.0724     0.1647    6.51  7.5e-11 ***
# x14           1.1253     0.1663    6.77  1.3e-11 ***
# x15           0.9311     0.1508    6.18  6.6e-10 ***
# x16           0.1707     0.1279    1.33   0.1820    
# x17           0.3410     0.1319    2.59   0.0097 ** 
# x18           0.1079     0.1411    0.77   0.4443    
# x19           0.1810     0.1414    1.28   0.2007    
# x20          -0.2914     0.1429   -2.04   0.0415 *  
# ---
# Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
# 
# (Dispersion parameter for binomial family taken to be 1)
# 
#     Null deviance: 655.68  on 499  degrees of freedom
# Residual deviance: 354.64  on 479  degrees of freedom
# AIC: 396.6
# 
# Number of Fisher Scoring iterations: 6

step.aic <- step(output2.aic)
summary(output2.aic)
# 
# Call:
# glm(formula = fml, family = "binomial", data = example2.dat)
# 
# Deviance Residuals: 
#    Min      1Q  Median      3Q     Max  
# -2.946  -0.424   0.195   0.565   2.925  
# 
# Coefficients:
#             Estimate Std. Error z value Pr(>|z|)    
# (Intercept)  -0.5304     0.3647   -1.45   0.1459    
# x1            1.4430     0.5267    2.74   0.0061 ** 
# x2            1.1011     0.4441    2.48   0.0132 *  
# x3            1.4722     0.3474    4.24  2.3e-05 ***
# x4            0.8851     0.3432    2.58   0.0099 ** 
# x5            0.7944     0.2965    2.68   0.0074 ** 
# x6            0.3805     0.2855    1.33   0.1826    
# x7            0.0703     0.2788    0.25   0.8008    
# x8           -0.1907     0.2793   -0.68   0.4948    
# x9            0.5860     0.2774    2.11   0.0347 *  
# x10           0.1488     0.2788    0.53   0.5935    
# x11           1.0633     0.1557    6.83  8.6e-12 ***
# x12           1.0856     0.1578    6.88  6.0e-12 ***
# x13           1.0724     0.1647    6.51  7.5e-11 ***
# x14           1.1253     0.1663    6.77  1.3e-11 ***
# x15           0.9311     0.1508    6.18  6.6e-10 ***
# x16           0.1707     0.1279    1.33   0.1820    
# x17           0.3410     0.1319    2.59   0.0097 ** 
# x18           0.1079     0.1411    0.77   0.4443    
# x19           0.1810     0.1414    1.28   0.2007    
# x20          -0.2914     0.1429   -2.04   0.0415 *  
# ---
# Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
# 
# (Dispersion parameter for binomial family taken to be 1)
# 
#     Null deviance: 655.68  on 499  degrees of freedom
# Residual deviance: 354.64  on 479  degrees of freedom
# AIC: 396.6
# 
# Number of Fisher Scoring iterations: 6
```

AIC æœ€ç»ˆçº³å…¥äº† 13 ä¸ªå˜é‡ï¼Œå…¶ä¸­ 11 ä¸ªå˜é‡æ˜¯å¯¹çš„ï¼Œä½†ç”¨çº³å…¥äº†ä¸¤ä¸ªäº‹å®ä¸Šåº”è¯¥æ˜¯æ— å…³çš„å˜é‡ã€‚æ‰€ä»¥ AIC çš„æ¨¡å‹å€¾å‘äºåå¤§ã€‚

**ç»“è®º**ï¼šAIC å’Œ BIC æ²¡æœ‰äºŒè€…ä¸ç›¸ä¼¯ä»²ï¼Œå¾ˆéš¾ä¸€å¥è¯è¯´æ¸…æ¥šäºŒè€…è°æ›´å¥½ã€‚ä½† BIC å¯¹äºä½œé¢„æµ‹è¡¨ç°æ›´å¥½ï¼Œè€Œä¸”èƒ½é‰´å®šæ··æ‚å› ç´ ã€‚

## Example 3: Low birth weight

æœ€åä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªçœŸå®æ•°æ®æ¥çœ‹ BIC åœ¨æ¨¡å‹é€‰æ‹©ä¸Šçš„ä¼˜åŠ¿ã€‚

æ•°æ®æ˜¯ MASS åŒ…è‡ªå¸¦çš„ birthwt æ•°æ®ï¼Œè¿™æ˜¯ä¸€ä¸ª 189 * 10 æè¿°ä½ä½“é‡æ–°ç”Ÿå„¿å¯èƒ½ç›¸å…³å› ç´ çš„æ•°æ®ï¼š

```
data("birthwt", package = 'MASS')
head(birthwt)
#    low age lwt race smoke ptl ht ui ftv  bwt
# 85   0  19 182    2     0   0  0  1   0 2523
# 86   0  33 155    3     0   0  0  0   3 2551
# 87   0  20 105    1     1   0  0  0   1 2557
# 88   0  21 108    1     1   0  0  1   2 2594
# 89   0  18 107    1     1   0  0  1   0 2600
# 91   0  21 124    3     0   0  0  0   0 2622
str(birthwt)
# 'data.frame':	189 obs. of  10 variables:
#  $ low  : int  0 0 0 0 0 0 0 0 0 0 ...
#  $ age  : int  19 33 20 21 18 21 22 17 29 26 ...
#  $ lwt  : int  182 155 105 108 107 124 118 103 123 113 ...
#  $ race : int  2 3 1 1 1 3 1 3 1 1 ...
#  $ smoke: int  0 0 1 1 1 0 0 0 1 1 ...
#  $ ptl  : int  0 0 0 0 0 0 0 0 0 0 ...
#  $ ht   : int  0 0 0 0 0 0 0 0 0 0 ...
#  $ ui   : int  1 0 0 1 1 0 0 0 0 0 ...
#  $ ftv  : int  0 3 1 2 0 0 1 1 1 0 ...
#  $ bwt  : int  2523 2551 2557 2594 2600 2622 2637 2637 2663 2665 ...
```

å…·ä½“å˜é‡çš„æ„æ€å¯ä»¥ `??birthwt` æŸ¥çœ‹ï¼Œæˆ‘è¿™é‡Œæˆªå›¾çš„åŸæ–‡é‡Œçš„ï¼š

<img src="/post/2019-01-16-logistic-regression-examples-aic-and-bic_files/lbw_data.png" alt="birthwt_data" width="80%" height="80%"/>

æˆ‘ä»¬æŠŠåˆ†ç±»å˜é‡è½¬å˜æˆ factorï¼Œå¹¶ä¸”ç”±äºæ˜¯åš Logistic å›å½’æ‰€ä»¥ bwt è¿™ä¸€åˆ—ä¹Ÿä¸è¦äº†ï¼š

```r
birthwt$smoke <- as.factor(birthwt$smoke)
birthwt$race <- as.factor(birthwt$race)
birthwt$ptl <- as.factor(birthwt$ptl)
birthwt$ht <- as.factor(birthwt$ht)
birthwt$ui <- as.factor(birthwt$ui)

birthwt <- subset(birthwt, select = -c(id, bwt))
summary(birthwt)
 #      low             age            lwt      race   smoke   ptl     ht     
 # Min.   :0.000   Min.   :14.0   Min.   : 80   1:96   0:115   0:159   0:177  
 # 1st Qu.:0.000   1st Qu.:19.0   1st Qu.:110   2:26   1: 74   1: 24   1: 12  
 # Median :0.000   Median :23.0   Median :121   3:67           2:  5          
 # Mean   :0.312   Mean   :23.2   Mean   :130                  3:  1          
 # 3rd Qu.:1.000   3rd Qu.:26.0   3rd Qu.:140                                 
 # Max.   :1.000   Max.   :45.0   Max.   :250                                 
 # ui           ftv       
 # 0:161   Min.   :0.000  
 # 1: 28   1st Qu.:0.000  
 #         Median :0.000  
 #         Mean   :0.794  
 #         3rd Qu.:1.000  
 #         Max.   :6.000
```

ç„¶åå°±å¯ä»¥äº†ï¼š

```r
output2 <- bic.glm(low ~ age + lwt + smoke + ptl + ht + ui +
                       ftv + race, glm.family = binomial, data = birthwt)
summary(output2)
```

![output3_summary](/post/2019-01-16-logistic-regression-examples-aic-and-bic_files/output3_summary.png)

çœ‹çœ‹å…¶ä»–çš„ï¼š

```r
output3$postprob
#  [1] 0.110709 0.077529 0.073286 0.068595 0.037462 0.034935 0.033014 0.026886 0.026275 0.025975 0.024136 0.023395
# [13] 0.022719 0.022593 0.022368 0.022217 0.020016 0.018094 0.015331 0.015111 0.014675 0.014476 0.014436 0.014214
# [25] 0.013791 0.013338 0.013117 0.012539 0.011803 0.011757 0.010826 0.010659 0.008751 0.008403 0.008373 0.008184
# [37] 0.008096 0.007983 0.007936 0.007680 0.007018 0.006979 0.006709 0.006611 0.006575 0.006431 0.006249 0.006180
# [49] 0.005564
output3$names
# [1] "age"   "lwt"   "smoke" "ptl"   "ht"    "ui"    "ftv"   "race" 
output3$probne0
#   age   lwt smoke   ptl    ht    ui   ftv  race 
#  12.6  68.7  33.2  35.1  65.4  33.8   1.5   9.6 
output3$postmean
# (Intercept)         age         lwt      smoke1        ptl1        ptl2        ptl3         ht1         ui1 
#    0.471634   -0.007765   -0.011558    0.255357    0.617360    0.168588   -4.910963    1.166893    0.310537 
#         ftv       race2       race3 
#   -0.001339    0.115279    0.092740 
```

åœ¨æ¨¡å‹ä¸­æ¯”ä¾‹æœ€é«˜çš„ lwt ä¹Ÿåªæœ‰ 68%ï¼Œæ‰€ä»¥æ€»ä½“æ¥è¯´éƒ½æ‰€ä»¥å˜é‡è¯æ®éƒ½ä¸å¤Ÿã€‚

## æ€»ç»“

å®é™…è¿ç”¨æœ€å¥½è¿˜æ˜¯ AIC å’Œ BIC éƒ½è€ƒè™‘ä¸€ä¸‹ï¼Œç„¶åè¿˜è¦ç»“åˆä¸“ä¸šçŸ¥è¯†å®é™…è€ƒè™‘å˜é‡çš„çº³å…¥å’Œå‰”é™¤ã€‚å¦‚æœæœ‰è¶³å¤Ÿçš„ä¸“ä¸šåªæ˜¯è®¤ä¸ºä¸€ä¸ªå˜é‡æ— è®ºè®¡ç®—ç»“æœå¦‚ä½•ï¼Œéƒ½åº”è¯¥çº³å…¥æ¨¡å‹ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å½“ç„¶åº”è¯¥çº³å…¥ã€‚BIC é‡Œä½¿ç”¨ `set.prior = 1` å°±è¡Œäº†ã€‚

åŒæ—¶ï¼Œå¦‚æœæ¨¡å‹çš„ç›®çš„æ˜¯åšé¢„æµ‹ï¼Œé‚£ä¹ˆå…¶å®åº”è¯¥å“ªäº›å˜é‡çº³å…¥å¹¶ä¸é‡è¦ï¼Œåªè¦æ¨¡å‹æ‹Ÿåˆçš„è¶³å¤Ÿå¥½å°±è¡Œäº†ã€‚ä½†æ˜¯å¦‚æœæ˜¯ä¸ºäº†çœ‹å“ªäº›å› ç´ æ¯”è¾ƒé‡è¦ä»¥åŠå„å˜é‡å’Œç»“æœä¹‹é—´çš„å…³ç³»å¼ºå¼±ï¼Œè¿™æ—¶å€™æ‰å¿…é¡»è¦è€ƒè™‘è¿™ä¸ªé—®é¢˜ã€‚

code: [logselect.BMA.R](/code/2019-01-16-logistic-regression-examples-aic-and-bic_files/logselect.BMA.R)
